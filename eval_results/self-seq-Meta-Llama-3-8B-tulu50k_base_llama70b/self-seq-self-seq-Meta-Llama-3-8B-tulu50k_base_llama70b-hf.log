[2024-06-13 15:04:54,026] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
[93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
[2024-06-13 15:04:54,915] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
[93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
Passed argument batch_size = auto:1. Detecting largest batch size
Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 8
Determined largest batch size: 8
hf (pretrained=simonycl/self-seq-Meta-Llama-3-8B-tulu50k_base_llama70b,dtype=bfloat16,attn_implementation=flash_attention_2), gen_kwargs: (temperature=0,top_k=0,top_p=0), limit: None, num_fewshot: 5, batch_size: auto (8)
|                 Tasks                 |Version|Filter|n-shot|Metric|   |Value |   |Stderr|
|---------------------------------------|-------|------|-----:|------|---|-----:|---|-----:|
|mmlu                                   |N/A    |none  |     0|acc   |â†‘  |0.5249|Â±  |0.0040|
|  - abstract_algebra                   |      0|none  |     5|acc   |â†‘  |0.2900|Â±  |0.0456|
|  - anatomy                            |      0|none  |     5|acc   |â†‘  |0.5407|Â±  |0.0430|
|  - astronomy                          |      0|none  |     5|acc   |â†‘  |0.5000|Â±  |0.0407|
|  - business_ethics                    |      0|none  |     5|acc   |â†‘  |0.5800|Â±  |0.0496|
|  - clinical_knowledge                 |      0|none  |     5|acc   |â†‘  |0.6642|Â±  |0.0291|
|  - college_biology                    |      0|none  |     5|acc   |â†‘  |0.5764|Â±  |0.0413|
|  - college_chemistry                  |      0|none  |     5|acc   |â†‘  |0.3400|Â±  |0.0476|
|  - college_computer_science           |      0|none  |     5|acc   |â†‘  |0.3400|Â±  |0.0476|
|  - college_mathematics                |      0|none  |     5|acc   |â†‘  |0.2900|Â±  |0.0456|
|  - college_medicine                   |      0|none  |     5|acc   |â†‘  |0.5549|Â±  |0.0379|
|  - college_physics                    |      0|none  |     5|acc   |â†‘  |0.2647|Â±  |0.0439|
|  - computer_security                  |      0|none  |     5|acc   |â†‘  |0.6700|Â±  |0.0473|
|  - conceptual_physics                 |      0|none  |     5|acc   |â†‘  |0.4511|Â±  |0.0325|
|  - econometrics                       |      0|none  |     5|acc   |â†‘  |0.3947|Â±  |0.0460|
|  - electrical_engineering             |      0|none  |     5|acc   |â†‘  |0.4483|Â±  |0.0414|
|  - elementary_mathematics             |      0|none  |     5|acc   |â†‘  |0.2963|Â±  |0.0235|
|  - formal_logic                       |      0|none  |     5|acc   |â†‘  |0.3254|Â±  |0.0419|
|  - global_facts                       |      0|none  |     5|acc   |â†‘  |0.2400|Â±  |0.0429|
|  - high_school_biology                |      0|none  |     5|acc   |â†‘  |0.6097|Â±  |0.0278|
|  - high_school_chemistry              |      0|none  |     5|acc   |â†‘  |0.3498|Â±  |0.0336|
|  - high_school_computer_science       |      0|none  |     5|acc   |â†‘  |0.5200|Â±  |0.0502|
|  - high_school_european_history       |      0|none  |     5|acc   |â†‘  |0.6667|Â±  |0.0368|
|  - high_school_geography              |      0|none  |     5|acc   |â†‘  |0.6414|Â±  |0.0342|
|  - high_school_government_and_politics|      0|none  |     5|acc   |â†‘  |0.7409|Â±  |0.0316|
|  - high_school_macroeconomics         |      0|none  |     5|acc   |â†‘  |0.5564|Â±  |0.0252|
|  - high_school_mathematics            |      0|none  |     5|acc   |â†‘  |0.2815|Â±  |0.0274|
|  - high_school_microeconomics         |      0|none  |     5|acc   |â†‘  |0.5672|Â±  |0.0322|
|  - high_school_physics                |      0|none  |     5|acc   |â†‘  |0.3642|Â±  |0.0393|
|  - high_school_psychology             |      0|none  |     5|acc   |â†‘  |0.7523|Â±  |0.0185|
|  - high_school_statistics             |      0|none  |     5|acc   |â†‘  |0.4352|Â±  |0.0338|
|  - high_school_us_history             |      0|none  |     5|acc   |â†‘  |0.6961|Â±  |0.0323|
|  - high_school_world_history          |      0|none  |     5|acc   |â†‘  |0.7848|Â±  |0.0268|
|  - human_aging                        |      0|none  |     5|acc   |â†‘  |0.6233|Â±  |0.0325|
|  - human_sexuality                    |      0|none  |     5|acc   |â†‘  |0.5191|Â±  |0.0438|
| - humanities                          |N/A    |none  |     5|acc   |â†‘  |0.4744|Â±  |0.0068|
|  - international_law                  |      0|none  |     5|acc   |â†‘  |0.6777|Â±  |0.0427|
|  - jurisprudence                      |      0|none  |     5|acc   |â†‘  |0.6759|Â±  |0.0452|
|  - logical_fallacies                  |      0|none  |     5|acc   |â†‘  |0.6564|Â±  |0.0373|
|  - machine_learning                   |      0|none  |     5|acc   |â†‘  |0.3750|Â±  |0.0460|
|  - management                         |      0|none  |     5|acc   |â†‘  |0.7087|Â±  |0.0450|
|  - marketing                          |      0|none  |     5|acc   |â†‘  |0.8162|Â±  |0.0254|
|  - medical_genetics                   |      0|none  |     5|acc   |â†‘  |0.6600|Â±  |0.0476|
|  - miscellaneous                      |      0|none  |     5|acc   |â†‘  |0.7420|Â±  |0.0156|
|  - moral_disputes                     |      0|none  |     5|acc   |â†‘  |0.5520|Â±  |0.0268|
|  - moral_scenarios                    |      0|none  |     5|acc   |â†‘  |0.2358|Â±  |0.0142|
|  - nutrition                          |      0|none  |     5|acc   |â†‘  |0.5229|Â±  |0.0286|
| - other                               |N/A    |none  |     5|acc   |â†‘  |0.6118|Â±  |0.0084|
|  - philosophy                         |      0|none  |     5|acc   |â†‘  |0.5884|Â±  |0.0280|
|  - prehistory                         |      0|none  |     5|acc   |â†‘  |0.6111|Â±  |0.0271|
|  - professional_accounting            |      0|none  |     5|acc   |â†‘  |0.3936|Â±  |0.0291|
|  - professional_law                   |      0|none  |     5|acc   |â†‘  |0.3794|Â±  |0.0124|
|  - professional_medicine              |      0|none  |     5|acc   |â†‘  |0.5772|Â±  |0.0300|
|  - professional_psychology            |      0|none  |     5|acc   |â†‘  |0.6095|Â±  |0.0197|
|  - public_relations                   |      0|none  |     5|acc   |â†‘  |0.5727|Â±  |0.0474|
|  - security_studies                   |      0|none  |     5|acc   |â†‘  |0.5224|Â±  |0.0320|
| - social_sciences                     |N/A    |none  |     5|acc   |â†‘  |0.6250|Â±  |0.0086|
|  - sociology                          |      0|none  |     5|acc   |â†‘  |0.7114|Â±  |0.0320|
| - stem                                |N/A    |none  |     5|acc   |â†‘  |0.4167|Â±  |0.0085|
|  - us_foreign_policy                  |      0|none  |     5|acc   |â†‘  |0.7100|Â±  |0.0456|
|  - virology                           |      0|none  |     5|acc   |â†‘  |0.4157|Â±  |0.0384|
|  - world_religions                    |      0|none  |     5|acc   |â†‘  |0.7368|Â±  |0.0338|

|      Groups      |Version|Filter|n-shot|Metric|   |Value |   |Stderr|
|------------------|-------|------|-----:|------|---|-----:|---|-----:|
|mmlu              |N/A    |none  |     0|acc   |â†‘  |0.5249|Â±  |0.0040|
| - humanities     |N/A    |none  |     5|acc   |â†‘  |0.4744|Â±  |0.0068|
| - other          |N/A    |none  |     5|acc   |â†‘  |0.6118|Â±  |0.0084|
| - social_sciences|N/A    |none  |     5|acc   |â†‘  |0.6250|Â±  |0.0086|
| - stem           |N/A    |none  |     5|acc   |â†‘  |0.4167|Â±  |0.0085|

[2024-06-13 15:17:21,788] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
[93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
[2024-06-13 15:17:22,551] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[93m [WARNING] [0m async_io requires the dev libaio .so object and headers but these were not found.
[93m [WARNING] [0m async_io: please install the libaio-dev package with apt
[93m [WARNING] [0m If libaio is already installed (perhaps from source), try setting the CFLAGS and LDFLAGS environment variables to where it can be found.
[93m [WARNING] [0m Please specify the CUTLASS repo directory as environment variable $CUTLASS_PATH
[93m [WARNING] [0m sparse_attn requires a torch version >= 1.5 and < 2.0 but detected 2.1
[93m [WARNING] [0m using untested triton version (2.1.0), only 1.0.0 is known to be compatible
Passed argument batch_size = auto:1. Detecting largest batch size
Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 16
Determined largest batch size: 16
hf (pretrained=simonycl/self-seq-Meta-Llama-3-8B-tulu50k_base_llama70b,dtype=bfloat16,attn_implementation=flash_attention_2), gen_kwargs: (temperature=0,top_k=0,top_p=0), limit: None, num_fewshot: 25, batch_size: auto (16)
|    Tasks    |Version|Filter|n-shot| Metric |   |Value |   |Stderr|
|-------------|------:|------|-----:|--------|---|-----:|---|-----:|
|arc_challenge|      1|none  |    25|acc     |â†‘  |0.4556|Â±  |0.0146|
|             |       |none  |    25|acc_norm|â†‘  |0.4838|Â±  |0.0146|

